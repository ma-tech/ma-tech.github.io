<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Woolz Image Processing: /export/data0/bill/MouseAtlas/Build/src/Woolz/libWlz/WlzKrig.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Woolz Image Processing
   &#160;<span id="projectnumber">Version 1.7.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('WlzKrig_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">WlzKrig.c File Reference<div class="ingroups"><a class="el" href="group__WlzValuesUtils.html">WlzValuesUtils</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for interpolation based on kriging.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gadc6c32a77af5803d77b09f84dec7c242"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#gadc6c32a77af5803d77b09f84dec7c242">WlzKrigSetModelFn</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *fn, <a class="el" href="WlzType_8h.html#a9825831ae48ac1f55c367b4c9bfe1fb6">WlzKrigModelFnType</a> type, double c0, double c1, double a)</td></tr>
<tr class="memdesc:gadc6c32a77af5803d77b09f84dec7c242"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a kriging function data stuctures parameters and function pointer. See the kriging model function types and their implementation for the meaning of the parameters.  <a href="group__WlzValuesUtils.html#gadc6c32a77af5803d77b09f84dec7c242">More...</a><br /></td></tr>
<tr class="separator:gadc6c32a77af5803d77b09f84dec7c242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7dffd7788b7cebeef8c36e7205dce1c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="WlzKrig_8c.html#ae7dffd7788b7cebeef8c36e7205dce1c">WlzKrigModelFnNugget</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:ae7dffd7788b7cebeef8c36e7205dce1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A nugget kriging variance model. </p><p class="formulaDsp">
\[ \left\{ \begin{array}{ll} h = 0 &amp; \gamma(h) = 0 \\ h &gt; 0 &amp; \gamma(h) = c_0 \end{array} \right. \]
</p>
<p>.  <a href="#ae7dffd7788b7cebeef8c36e7205dce1c">More...</a><br /></td></tr>
<tr class="separator:ae7dffd7788b7cebeef8c36e7205dce1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67bae22dd5b733bd9f495618f6038599"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga67bae22dd5b733bd9f495618f6038599">WlzKrigModelFnLinear</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:ga67bae22dd5b733bd9f495618f6038599"><td class="mdescLeft">&#160;</td><td class="mdescRight">A linear kriging variance model. </p><p class="formulaDsp">
\[ \left\{ \begin{array}{ll} h &lt; a &amp; \gamma(h) = c_0 + \frac{(c_1 - c_0)}{a} h \\ h \geq a &amp; \gamma(h) = c_1 \end{array} \right. \]
</p>
<p>.  <a href="group__WlzValuesUtils.html#ga67bae22dd5b733bd9f495618f6038599">More...</a><br /></td></tr>
<tr class="separator:ga67bae22dd5b733bd9f495618f6038599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafac2d8f223c34f39e1b6273d26e3ad71"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#gafac2d8f223c34f39e1b6273d26e3ad71">WlzKrigModelFnSpherical</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:gafac2d8f223c34f39e1b6273d26e3ad71"><td class="mdescLeft">&#160;</td><td class="mdescRight">A spherical kriging variance model. </p><p class="formulaDsp">
\[ \left\{ \begin{array}{ll} 0 &lt; h \leq a &amp; \gamma(h) = c_0 + c_1 \frac{1}{2} (\frac{3h}{a} - \frac{h^3}{a^3}) \\ h &gt; a &amp; \gamma(h) = c_0 + c_1 \end{array} \right. \]
</p>
<p>.  <a href="group__WlzValuesUtils.html#gafac2d8f223c34f39e1b6273d26e3ad71">More...</a><br /></td></tr>
<tr class="separator:gafac2d8f223c34f39e1b6273d26e3ad71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07125350191ad8c6e47b34e40b9e6149"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga07125350191ad8c6e47b34e40b9e6149">WlzKrigModelFnExponential</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:ga07125350191ad8c6e47b34e40b9e6149"><td class="mdescLeft">&#160;</td><td class="mdescRight">An exponential kriging variance model. </p><p class="formulaDsp">
\[ \gamma(h) = c_0 + c_1(1 - e^{-\frac{h}{a}}) \]
</p>
<p>.  <a href="group__WlzValuesUtils.html#ga07125350191ad8c6e47b34e40b9e6149">More...</a><br /></td></tr>
<tr class="separator:ga07125350191ad8c6e47b34e40b9e6149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga418aaa02a2dc63e654eaec6fc013f0a6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga418aaa02a2dc63e654eaec6fc013f0a6">WlzKrigModelFnGaussian</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:ga418aaa02a2dc63e654eaec6fc013f0a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Gaussian kriging variance model. </p><p class="formulaDsp">
\[ \gamma(h) = c_0 + c_1(1 - e^{-(\frac{h}{a})^2}) \]
</p>
<p>.  <a href="group__WlzValuesUtils.html#ga418aaa02a2dc63e654eaec6fc013f0a6">More...</a><br /></td></tr>
<tr class="separator:ga418aaa02a2dc63e654eaec6fc013f0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8ddac0510479bd53519559bf57dc6f5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#gad8ddac0510479bd53519559bf57dc6f5">WlzKrigModelFnQuadratic</a> (<a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *f, double h)</td></tr>
<tr class="memdesc:gad8ddac0510479bd53519559bf57dc6f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Quadratic kriging variance model. </p><p class="formulaDsp">
\[ \gamma(h) = c_0 + c_1 \left( \frac{ (\frac{h}{a})^2} {1 + (\frac{h}{a})^2} \right) \]
</p>
<p>.  <a href="group__WlzValuesUtils.html#gad8ddac0510479bd53519559bf57dc6f5">More...</a><br /></td></tr>
<tr class="separator:gad8ddac0510479bd53519559bf57dc6f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4851791b8ce7a013fc1b01f6bb81947"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#gad4851791b8ce7a013fc1b01f6bb81947">WlzKrigOSetModelSV2D</a> (<a class="el" href="AlgType_8h.html#ae6d642347ce83603e551005e65cff39f">AlgMatrix</a> modelSV, <a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *modelFn, int n, <a class="el" href="WlzType_8h.html#af6f84845c2e3284f96effbee294297e4">WlzDVertex2</a> *nbr, int *wSp)</td></tr>
<tr class="memdesc:gad4851791b8ce7a013fc1b01f6bb81947"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ordinary kriging model semi-variogram from the given neighbourhood vertices.  <a href="group__WlzValuesUtils.html#gad4851791b8ce7a013fc1b01f6bb81947">More...</a><br /></td></tr>
<tr class="separator:gad4851791b8ce7a013fc1b01f6bb81947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e44f1bad8f1aebc6cda45bebcacb518"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga9e44f1bad8f1aebc6cda45bebcacb518">WlzKrigOSetModelSV3D</a> (<a class="el" href="AlgType_8h.html#ae6d642347ce83603e551005e65cff39f">AlgMatrix</a> modelSV, <a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *modelFn, int n, <a class="el" href="WlzType_8h.html#ac55f436a7c43b0e59c3a948f88036c8f">WlzDVertex3</a> *nbr, int *wSp)</td></tr>
<tr class="memdesc:ga9e44f1bad8f1aebc6cda45bebcacb518"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ordinary kriging model semi-variogram from the given neighbourhood vertices.  <a href="group__WlzValuesUtils.html#ga9e44f1bad8f1aebc6cda45bebcacb518">More...</a><br /></td></tr>
<tr class="separator:ga9e44f1bad8f1aebc6cda45bebcacb518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac47d951fdf59c7e64c3ed2021167d5f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#gac47d951fdf59c7e64c3ed2021167d5f7">WlzKrigOSetPosSV2D</a> (double *posSV, <a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *modelFn, int n, <a class="el" href="WlzType_8h.html#af6f84845c2e3284f96effbee294297e4">WlzDVertex2</a> *nbr, <a class="el" href="WlzType_8h.html#af6f84845c2e3284f96effbee294297e4">WlzDVertex2</a> pos)</td></tr>
<tr class="memdesc:gac47d951fdf59c7e64c3ed2021167d5f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ordinary kriging position semi-variogram from the given neighbourhood vertices and the given position vertex.  <a href="group__WlzValuesUtils.html#gac47d951fdf59c7e64c3ed2021167d5f7">More...</a><br /></td></tr>
<tr class="separator:gac47d951fdf59c7e64c3ed2021167d5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e08708beb53ff5c97cba9e5a2b545b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga0e08708beb53ff5c97cba9e5a2b545b2">WlzKrigOSetPosSV3D</a> (double *posSV, <a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *modelFn, int n, <a class="el" href="WlzType_8h.html#ac55f436a7c43b0e59c3a948f88036c8f">WlzDVertex3</a> *nbr, <a class="el" href="WlzType_8h.html#ac55f436a7c43b0e59c3a948f88036c8f">WlzDVertex3</a> pos)</td></tr>
<tr class="memdesc:ga0e08708beb53ff5c97cba9e5a2b545b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ordinary kriging position semi-variogram from the given neighbourhood vertices and the given position vertex.  <a href="group__WlzValuesUtils.html#ga0e08708beb53ff5c97cba9e5a2b545b2">More...</a><br /></td></tr>
<tr class="separator:ga0e08708beb53ff5c97cba9e5a2b545b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga327fd87e0f1fe8088a1efcddd8c83f44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga327fd87e0f1fe8088a1efcddd8c83f44">WlzKrigOWeightsSolve</a> (<a class="el" href="AlgType_8h.html#ae6d642347ce83603e551005e65cff39f">AlgMatrix</a> modelSV, double *posSV, int *wSp, double eps)</td></tr>
<tr class="memdesc:ga327fd87e0f1fe8088a1efcddd8c83f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the ordinary kriging weights from the model and position semi-variograms.  <a href="group__WlzValuesUtils.html#ga327fd87e0f1fe8088a1efcddd8c83f44">More...</a><br /></td></tr>
<tr class="separator:ga327fd87e0f1fe8088a1efcddd8c83f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4eb3e08cdcbbb0bb16a4a809e3b046e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga4eb3e08cdcbbb0bb16a4a809e3b046e7">WlzKrigReallocBuffers2D</a> (<a class="el" href="WlzType_8h.html#af6f84845c2e3284f96effbee294297e4">WlzDVertex2</a> **dstNbrPosBuf, double **dstPosSV, int **dstWSp, <a class="el" href="AlgType_8h.html#ae6d642347ce83603e551005e65cff39f">AlgMatrix</a> *dstModelSV, int *dstMaxKrigBuf, int nNbrC, int nNbrL)</td></tr>
<tr class="memdesc:ga4eb3e08cdcbbb0bb16a4a809e3b046e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A convinience function for allocating and reallocating the buffers needed for 2D kriging. All given pointers must be valid and on the first call all pointer values (eg *dstNbrPosBuf) must be NULL.  <a href="group__WlzValuesUtils.html#ga4eb3e08cdcbbb0bb16a4a809e3b046e7">More...</a><br /></td></tr>
<tr class="separator:ga4eb3e08cdcbbb0bb16a4a809e3b046e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c47aa826b21adf32551a6e3749bdb05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="WlzError_8h.html#accff28019afa8da97a4990e1c0890ed7">WlzErrorNum</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__WlzValuesUtils.html#ga1c47aa826b21adf32551a6e3749bdb05">WlzKrigReallocBuffers3D</a> (<a class="el" href="WlzType_8h.html#ac55f436a7c43b0e59c3a948f88036c8f">WlzDVertex3</a> **dstNbrPosBuf, double **dstPosSV, int **dstWSp, <a class="el" href="AlgType_8h.html#ae6d642347ce83603e551005e65cff39f">AlgMatrix</a> *dstModelSV, int *dstMaxKrigBuf, int nNbrC, int nNbrL)</td></tr>
<tr class="memdesc:ga1c47aa826b21adf32551a6e3749bdb05"><td class="mdescLeft">&#160;</td><td class="mdescRight">A convinience function for allocating and reallocating the buffers needed for 3D kriging. All given pointers must be valid and on the first call all pointer values (eg *dstNbrPosBuf) must be NULL.  <a href="group__WlzValuesUtils.html#ga1c47aa826b21adf32551a6e3749bdb05">More...</a><br /></td></tr>
<tr class="separator:ga1c47aa826b21adf32551a6e3749bdb05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for interpolation based on kriging. </p>
<dl class="section author"><dt>Author</dt><dd>Bill Hill </dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 2012 </dd></dl>
<dl class="section version"><dt>Version</dt><dd></dd></dl>
<dl class="section rcs"><dt>Id</dt><dd>44a4631c99a5a59dc0b6b7a55014432b84db2bd2 </dd></dl>
<dl class="section user"><dt></dt><dd>Address: MRC Human Genetics Unit, MRC Institute of Genetics and Molecular Medicine, University of Edinburgh, Western General Hospital, Edinburgh, EH4 2XU, UK. </dd></dl>
<dl class="section user"><dt></dt><dd>Copyright (C), [2012], The University Court of the University of Edinburgh, Old College, Edinburgh, UK.</dd></dl>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA. Kriging is an interpolation method from geo-statistics (hence some terms such as nugget), which aims to find the Best Linear Unbiased Estimate (BLUE) of a value at some point in space based on the semi-variograms of the values within some local region. The procedure is first to choose a model for the semi-variogram behavior which when plotted against the lag (distance) is assumed to have a nugget (constant or intercept variance), sill (variance at an infinite lag) and range (lag for which values have little correlation). This should be set using <a class="el" href="group__WlzValuesUtils.html#gadc6c32a77af5803d77b09f84dec7c242" title="Sets a kriging function data stuctures parameters and function pointer. See the kriging model functio...">WlzKrigSetModelFn()</a>. The model semi-variogram should then be computed using <a class="el" href="group__WlzValuesUtils.html#gad4851791b8ce7a013fc1b01f6bb81947" title="Computes the ordinary kriging model semi-variogram from the given neighbourhood vertices. ">WlzKrigOSetModelSV2D()</a> and then for each position to be interpolated with this model (ie all positions where the model is valid) <a class="el" href="group__WlzValuesUtils.html#gac47d951fdf59c7e64c3ed2021167d5f7" title="Computes the ordinary kriging position semi-variogram from the given neighbourhood vertices and the g...">WlzKrigOSetPosSV2D()</a> should be called followed by <a class="el" href="group__WlzValuesUtils.html#ga327fd87e0f1fe8088a1efcddd8c83f44" title="Computes the ordinary kriging weights from the model and position semi-variograms. ">WlzKrigOWeightsSolve()</a>.</p>
<p>For a simple system in which there are \(N\) known values \(\{v_i\}\) at positions \(\{p_i\}\) ( \(i \in [1-N]\)) then we want to estimate a system of weights \(\{w_i\}\) such that the value \(v_x\) at some position \(p_x\) can be computed by a simple linear system of weights </p><p class="formulaDsp">
\[ v_x = \sum_i w_i v_i \]
</p>
<p> with the weights computed such that \( \sum_i w_i = 1\). Setting \(h_{ij} = \|p_i - p_j\|\) and having choosen a variance model \(\gamma\) then </p><p class="formulaDsp">
\[ \mathbf{M} \mathbf{w} = \mathbf{p} \]
</p>
<p> where \(\mathbf{M} = \gamma(h_{ij})\), \(\mathbf{w} = w_j\) and \(\mathbf{p} = h_{i}\). In practice a slack variable \(\lambda\) is added to the weights column vector and both the model matrix and position vector are padded using to 1. This equation is then solved for the weights. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae7dffd7788b7cebeef8c36e7205dce1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double WlzKrigModelFnNugget </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="WlzType_8h.html#abbc16bdbc748556bd31781ccda1c3b12">WlzKrigModelFn</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A nugget kriging variance model. </p><p class="formulaDsp">
\[ \left\{ \begin{array}{ll} h = 0 &amp; \gamma(h) = 0 \\ h &gt; 0 &amp; \gamma(h) = c_0 \end{array} \right. \]
</p>
<p>. </p>
<dl class="section return"><dt>Returns</dt><dd>Function output value.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>The kriging function data stucture. </td></tr>
    <tr><td class="paramname">h</td><td>Function input value. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="struct__WlzKrigModelFn.html#a9401f28b20847c6e9ae501f70af6592b">_WlzKrigModelFn::c0</a>.</p>

<p>Referenced by <a class="el" href="group__WlzValuesUtils.html#gadc6c32a77af5803d77b09f84dec7c242">WlzKrigSetModelFn()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_65956747a6f6d37dadfdcf67b1aa1faa.html">export</a></li><li class="navelem"><a class="el" href="dir_2018007bf66c9100e936892e74c64b43.html">data0</a></li><li class="navelem"><a class="el" href="dir_4bb0f7e1a88140968c27b92ff9033d7f.html">bill</a></li><li class="navelem"><a class="el" href="dir_cabdcef9fcf371de8153fc26197c5758.html">MouseAtlas</a></li><li class="navelem"><a class="el" href="dir_17dd8dec4860e6fc90b12699630b176f.html">Build</a></li><li class="navelem"><a class="el" href="dir_010a83c83a30d5c8b78f1cbc74f896dc.html">src</a></li><li class="navelem"><a class="el" href="dir_1e504b236fc456e6cd3e861254fe9123.html">Woolz</a></li><li class="navelem"><a class="el" href="dir_9cd6cbea1b3060a480d72286f7cc4af1.html">libWlz</a></li><li class="navelem"><a class="el" href="WlzKrig_8c.html">WlzKrig.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
